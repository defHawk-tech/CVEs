# CVE-2025-11953: Command Injection in React Native CLI

---

## Overview

A **critical command injection vulnerability** was discovered in the `@react-native-community/cli-server-api` package, affecting the Metro development server used in React Native projects. The server exposes an HTTP POST endpoint at `/open-url` which is intended to open URLs for the developer.

The vulnerability stems from the server directly using user-provided input from the `url` parameter in a system shell command without proper sanitization or validation. Because the Metro server binds to all network interfaces (`0.0.0.0`) by default, it allows unauthenticated attackers on the same network to execute arbitrary commands on the developer's machine, leading to Remote Code Execution (RCE).

- **Severity:** Critical (CVSS 9.8)
- **Impact:** Remote Code Execution (RCE)
- **Attack Vector:** Network (no authentication required)
- **Discovered by:** JFrog Security Research Team
- **Affected Versions:** `>= 4.8.0` and `< 20.0.0`
- **Fixed in:** Version `20.0.0` and above

---

## Affected Software

| Package Name | Vulnerable Version Range | Patched Version |
| :--- | :--- | :--- |
| `@react-native-community/cli-server-api` | `>= 4.8.0` and `< 20.0.0` | `20.0.0` and higher |

This primarily impacts developers running a vulnerable version of the Metro development server during the application development lifecycle.

---

## Root Cause Analysis

The core of the vulnerability is the improper handling of user-supplied data within the `/open-url` endpoint. The server code takes the `url` value from a POST request and directly concatenates it into a shell command executed by Node.js's `child_process.exec`.

---

**Vulnerable Code Snippet (Simplified):**
```
const { exec } = require('child_process');

// The server receives a request with a 'url' in the body.
const url = req.body.url;

// The 'url' is directly passed into the exec function without sanitization.
// This is the command injection flaw.
exec(start ${url}, (error, stdout, stderr) => {
// ... handles command output
});
```
An attacker can exploit this by sending a `url` string that contains shell operators like `&&` or `||`. The operating system's shell will execute the command that follows the operator.

---

## Proof of Concept (PoC) Demonstration

This repository contains a minimal web application to demonstrate the vulnerability in a safe, controlled environment.

*   `server.js`: An Express server that simulates the vulnerable Metro server. It has a `/open-url` endpoint that contains the command injection flaw.
*   `index.html`: A user-facing web form that allows a user to submit data, including a "Profile Link". This field is intentionally vulnerable and is passed to the server's vulnerable endpoint.
---

### How the Demo Exploits the Vulnerability

1.  The user fills out the form in `index.html`.
2.  In the "Profile Link" field, the user enters a malicious payload.
3.  Upon submission, the form's JavaScript sends only the "Profile Link" content to the `/open-url` endpoint on the `server.js`.
4.  The server executes the `exec(\`start ${profile_link_payload}\`)` command.
5.  The OS shell processes the command, including any injected malicious commands.

---

## Installation and Usage Guide

### Requirements
*   Node.js and npm

### Setup
1.  Save the `server.js` and `index.html` files into a new directory.
2.  Open a terminal in that directory and install the required dependency:
    ```
    npm install 
    ```
3.  Start the vulnerable demo server:
    ```
    node server.js
    ```
    You should see the message: `Vulnerable server running on http://localhost:3000`

### Running the Exploit
1.  Open your web browser and navigate to:
    ```
    http://localhost:3000
    ```
2.  You will see a profile submission form. Fill in the "Name" and "Stream" fields with any text.
3.  In the **"Profile Link"** field, enter the malicious payload.

**Example Payloads (for Windows):**

*   To open the Calculator:
    ```
    https://github.com/example && calc.exe
    ```
*   To open Command Prompt:
    ```
    cmd.exe
    ```
**Example Payloads (for Linux):**

* To open a terminal (gnome-terminal on many distros):
  ```
  https://github.com/example; gnome-terminal
  ```
* To list directory contents:
  ```
  https://github.com/example; ls -la
  ```
  
4.  Click the "Submit Form" button.
5.  If successful, the injected application (e.g., Calculator) will open on the machine running the server, confirming the RCE vulnerability. The server's response will be displayed in the black output box on the webpage.

---

##  Mitigation and Remediation

*   **Update Dependencies:** The primary fix is to upgrade the `@react-native-community/cli-server-api` package to version **20.0.0** or newer.
    ```
    npm update @react-native-community/cli-server-api
    ```
*   **Restrict Host Binding:** Configure the Metro server to only listen on `localhost` (`127.0.0.1`) instead of the default `0.0.0.0`. This prevents external network access.
*   **Use Secure Coding Practices:** Never trust user input. Always sanitize and validate data before using it in system commands, database queries, or other sensitive operations.

---

## 7. References

*   **JFrog Blog:** [https://jfrog.com/blog/cve-2025-11953-critical-react-native-community-cli-vulnerability/]
*   **Snyk Advisory:** [https://security.snyk.io/vuln/SNYK-JS-REACTNATIVECOMMUNITYCLISERVERAPI-13836141]
*   **Public PoC:** [https://github.com/SaidBenaissa/cve-2025-11953-vulnerability-demo]