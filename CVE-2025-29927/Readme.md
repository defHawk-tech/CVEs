# Overview of CVE-2025-29927
Next.js uses an internal header `x-middleware-subrequest` to prevent recursive requests from triggering infinite loops. The security report showed it was possible to skip running Middleware, which could allow requests to skip critical checks—such as authorization cookie validation—before reaching routes.

## Root Cause of the Vulnerability
- **Improper Input Validation:**
  - The root cause reflects a classic security oversight, trusting client-controlled input in a server-side decision-making process.
  - Malicious actors can manipulate the response to bypass authentication checks.
- **Response Manipulation Vulnerability:**
  - The Next.js team likely assumed that `x-middleware-subrequest` would only be set internally by the framework or trusted infrastructure (e.g., Vercel’s edge runtime), not anticipating self-hosted scenarios where clients could manipulate it.
- **Lack of Server-Side Validation:**
  - No secondary verification is performed on the server-side to ensure response integrity.

## Exploitation Vector
Attackers can manipulate the client-server authentication flow by intercepting and modifying API responses. Example attack steps:

1. Capture the authentication request using tools like Burp Suite or ZAP.
2. Send a request to a protected route (e.g., `/admin`) with the header:
```
x-middleware-subrequest: middleware:middleware:middleware
```
3. Gain unauthorized access to the application.

## Patches

- For Next.js **15.x**, this issue is fixed in **15.2.3**
- For Next.js **14.x**, this issue is fixed in **14.2.25**
- For Next.js **13.x**, this issue is fixed in **13.5.9**
- For Next.js **12.x**, this issue is fixed in **12.3.5**
- For Next.js **11.x**, consult the below workaround.

**Note:** Next.js deployments hosted on Vercel are automatically protected against this vulnerability.

## Impact of the Fixes
- Prevents unauthorized access through manipulated responses.
- Strengthens overall authentication security.
- Improves logging for easier detection of attacks.

## Conclusion
CVE-2025-29927 exposes a critical flaw in Next.js middleware, allowing attackers to bypass security controls with a single HTTP header. Self-hosted applications on outdated versions should update immediately or implement header filtering as a stopgap. The vulnerability underscores the importance of validating internal mechanisms against external tampering and maintaining layered security in web applications. If you’re running Next.js, check your version and deployment setup now—time is of the essence.

