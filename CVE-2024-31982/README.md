# CVE-2024-31982 - XWiki Remote Code Execution (RCE)

## Overview
**CVE-2024-31982** is a **Remote Code Execution (RCE)** vulnerability discovered in **XWiki**, a popular open-source wiki platform. The vulnerability exists in the **xwiki-platform-search-ui** component, allowing an attacker to execute arbitrary commands on the server due to improper input validation.

## Affected Versions
The following versions of `org.xwiki.platform:xwiki-platform-search-ui` are vulnerable:

- **2.4-milestone-1** up to **before 14.10.20**
- **15.0-rc-1** up to **before 15.5.4**
- **15.6-rc-1** up to **before 15.10-rc-1**

### Patched Versions:
- **14.10.20**
- **15.5.4**
- **15.10-rc-1**

## Root Cause
The vulnerability arises due to **insufficient input validation** in the search functionality. XWiki fails to properly sanitize user-controlled input, which can lead to command injection, allowing attackers to execute arbitrary system commands remotely.

## Impact
A successful exploit of **CVE-2024-31982** can allow an attacker to:
- Execute arbitrary system commands on the XWiki server.
- Gain unauthorized access to sensitive data.
- Compromise the underlying infrastructure.
- Potentially achieve full server takeover.

## Exploitation Scenario
An attacker can exploit this vulnerability by injecting malicious input through the XWiki search feature or another exposed endpoint. If the input is executed by the server without proper sanitization, it can lead to **Remote Code Execution**.

## Mitigation
To protect against **CVE-2024-31982**, users should:
1. **Update XWiki** to one of the patched versions:  
   - **14.10.20**  
   - **15.5.4**  
   - **15.10-rc-1**
2. Restrict access to the XWiki search feature if unnecessary.
3. Implement Web Application Firewalls (WAF) to detect and block suspicious input.
4. Regularly audit logs for signs of exploitation.

## References
- [XWiki Official Site](https://www.xwiki.org/)
- [CVE Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-31982)

> âš  **Disclaimer:** This information is provided for educational and research purposes only. Exploiting vulnerabilities in unauthorized environments is illegal.

---

# How to Set Up the Vulnerable Lab
1. Clone the Repository (or create a new directory)

```
git clone https://github.com/your-repo/xwiki-cve-2024-31982
cd xwiki-cve-2024-31982
```

2. Run the Lab
```
   docker-compose up -d
```

3. Access XWiki
Open http://localhost:8080/ in your browser.

4. Stop the Lab
```
docker-compose down
```

5. Clean Up (If Needed)
```
docker volume prune -f
```
